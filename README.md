---
title: "R Notebook"
output: 
  html_document: 
    keep_md: yes
keep_md: TRUE
---

Loading Required packages


```r
library(ggplot2)
```

```
## Warning: package 'ggplot2' was built under R version 4.1.1
```

```
## Registered S3 methods overwritten by 'tibble':
##   method     from  
##   format.tbl pillar
##   print.tbl  pillar
```

```r
library(ggthemes)
```

```
## Warning: package 'ggthemes' was built under R version 4.1.3
```

```r
library(lubridate)
```

```
## 
## Attaching package: 'lubridate'
```

```
## The following objects are masked from 'package:base':
## 
##     date, intersect, setdiff, union
```

```r
library(dplyr)
```

```
## 
## Attaching package: 'dplyr'
```

```
## The following objects are masked from 'package:stats':
## 
##     filter, lag
```

```
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
```

```r
library(tidyr)
library(DT)
library(scales)
```

Set working directory


```r
setwd("D:/3S/DATASET'S/Uber-dataset")
```

## Creating color palette for plots


```r
colors = c("#CC1011", "#665555", "#05a399", "#cfcaca", "#f5e840", "#0683c9", "#e075b0")
```

## Reading Data from directory into Data frames


```r
apr_data <- read.csv("uber-raw-data-apr14.csv")
may_data <- read.csv("uber-raw-data-may14.csv")
jun_data <- read.csv("uber-raw-data-jun14.csv")
jul_data <- read.csv("uber-raw-data-jul14.csv")
aug_data <- read.csv("uber-raw-data-aug14.csv")
sep_data <- read.csv("uber-raw-data-sep14.csv")

# Combine the data together 
uber_data_raw <- rbind(apr_data, may_data, jun_data, jul_data, aug_data, sep_data)
cat("The dimensions of the data are:", dim(uber_data_raw))
```

```
## The dimensions of the data are: 4534327 4
```


```r
head(uber_data_raw)
```

```
##          Date.Time     Lat      Lon   Base
## 1 4/1/2014 0:11:00 40.7690 -73.9549 B02512
## 2 4/1/2014 0:17:00 40.7267 -74.0345 B02512
## 3 4/1/2014 0:21:00 40.7316 -73.9873 B02512
## 4 4/1/2014 0:28:00 40.7588 -73.9776 B02512
## 5 4/1/2014 0:33:00 40.7594 -73.9722 B02512
## 6 4/1/2014 0:33:00 40.7383 -74.0403 B02512
```

## Formatting The Raw Data

The data contains the columns Date.Time which is a factor, Latitude and Longitudes which are double and Base which is factor. we will format the datetime into a more readable format using the Date Time conversion function.


```r
uber_data_raw$Date.Time <- as.POSIXct(uber_data_raw$Date.Time, format="%m/%d/%Y %H:%M:%S")
uber_data_raw$Time <- format(as.POSIXct(uber_data_raw$Date.Time, format = "%m/%d/%Y %H:%M:%S"), format="%H:%M:%S")

uber_data_raw$Date.Time <- ymd_hms(uber_data_raw$Date.Time)
```

### Create individual columns for month day and year


```r
# Create individual columns for month day and year
uber_data_raw$day <- factor(day(uber_data_raw$Date.Time))
uber_data_raw$month <- factor(month(uber_data_raw$Date.Time, label=TRUE))
uber_data_raw$year <- factor(year(uber_data_raw$Date.Time))
uber_data_raw$dayofweek <- factor(wday(uber_data_raw$Date.Time, label=TRUE))
```

Adding Time variables as well


```r
# Add Time variables as well 
uber_data_raw$second = factor(second(hms(uber_data_raw$Time)))
uber_data_raw$minute = factor(minute(hms(uber_data_raw$Time)))
uber_data_raw$hour = factor(hour(hms(uber_data_raw$Time)))
uber_data <- uber_data_raw
```

# Data Visualization

### Plotting the trips by the hours in a day


```r
hourly_data <- uber_data |> 
                group_by(hour) |> 
                        dplyr::summarize(Total = n())
```

```
## `summarise()` ungrouping output (override with `.groups` argument)
```

```r
#Shows data in a searchable JS Table
datatable(hourly_data)
```

```{=html}
<div id="htmlwidget-8aa5eeef73df2ef9be16" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-8aa5eeef73df2ef9be16">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],[103836,67227,45865,48287,55230,83939,143213,193094,190504,159967,159148,165703,170452,195877,230625,275466,313400,336190,324679,294513,284604,281460,241858,169190]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>hour<\/th>\n      <th>Total<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```


```r
ggplot(hourly_data,aes(hour,Total))+
geom_bar(stat = "identity",
         fill = "steelblue",
         color = "red")+
ggtitle("Trips Every Hour", subtitle = "aggregated today") + 
theme(legend.position = "none", 
      plot.title = element_text(hjust = 0.5), 
      plot.subtitle = element_text(hjust = 0.5)) + 
scale_y_continuous(labels=comma)
```

![](Uber_Data_analysis2_files/figure-html/unnamed-chunk-10-1.png)<!-- -->


```r
monthly_hour_data <- uber_data |> group_by(month,hour) |> dplyr::summarize(Total=n())
```

```
## `summarise()` regrouping output by 'month' (override with `.groups` argument)
```

```r
datatable(monthly_hour_data)
```

```{=html}
<div id="htmlwidget-02b3fa8c919f8650654c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-02b3fa8c919f8650654c">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144"],["Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep"],["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],[11910,7769,4935,5040,6095,9476,18498,24924,22843,17939,17865,18774,19425,22603,27190,35324,42003,45475,43003,38923,36244,36964,30645,20649,13875,8186,5372,5946,6945,10789,21015,27413,25460,20507,20801,22055,23595,27699,34363,43087,49127,51508,48965,42387,40731,42217,35556,24836,14514,9167,6189,6937,7701,11955,22030,30834,29771,24298,23584,24155,25233,28937,34428,41586,48162,50452,45013,38203,40108,40791,35614,24182,17953,11527,8562,9199,10040,14932,23456,32545,33387,28486,28558,30120,30900,35832,41357,46053,52403,58260,57268,52332,51859,49528,42218,29346,21451,14471,10105,10376,11774,16525,24907,34064,34566,30195,30706,31778,32106,35764,40644,48197,53481,57122,55390,53008,51674,51354,46008,33609,24133,16107,10702,10789,12675,20262,33307,43314,44477,38542,37634,38821,39193,45042,52643,61219,68224,73373,75040,69660,63988,60606,51817,36568]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>month<\/th>\n      <th>hour<\/th>\n      <th>Total<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```

\`summarise()\` has grouped output by 'month'. You can override using the \`.groups\` argument.

#### **Plotting trips by hour and month**


```r
ggplot(monthly_hour_data,aes(hour,Total,fill = month ))+
    geom_bar(stat = "identity")+
    ggtitle("Trips by Hourly Travel and month")+
    scale_y_continuous(labels = comma)
```

![](Uber_Data_analysis2_files/figure-html/unnamed-chunk-12-1.png)<!-- -->

## **Plotting data by trips during every day of the month**


```r
day_data <- uber_data |> group_by(day) |> dplyr::summarize(Trips=n())
```

```
## `summarise()` ungrouping output (override with `.groups` argument)
```

```r
datatable(day_data)
```

```{=html}
<div id="htmlwidget-c33cc271b40b77c9be88" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c33cc271b40b77c9be88">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],[127430,143201,142983,140923,147054,139886,143503,145984,155135,152500,148860,160606,156892,140148,153726,158921,152524,151319,153088,144179,141112,146952,156032,144169,152667,153405,145652,141157,149086,167160,78073]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>day<\/th>\n      <th>Trips<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```

#### 

Plot the data for the day


```r
ggplot(day_data,aes(day,Trips))+
    geom_bar(stat = "identity",
             color = "steelblue")+
    ggtitle("Trips for each day of month")+
    theme(legend.position = "none")+
    scale_y_continuous(labels = comma)
```

![](Uber_Data_analysis2_files/figure-html/unnamed-chunk-14-1.png)<!-- -->

## **Plotting data by trips during every day of the week in month**


```r
dow_monthly_data <- uber_data |> group_by(dayofweek, month) |> dplyr::summarize(Trips = n())
```

```
## `summarise()` regrouping output by 'dayofweek' (override with `.groups` argument)
```

```r
datatable(dow_monthly_data)
```

```{=html}
<div id="htmlwidget-f8ebc867f946cfb8b40a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f8ebc867f946cfb8b40a">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42"],["Sun","Sun","Sun","Sun","Sun","Sun","Mon","Mon","Mon","Mon","Mon","Mon","Tue","Tue","Tue","Tue","Tue","Tue","Wed","Wed","Wed","Wed","Wed","Wed","Thu","Thu","Thu","Thu","Thu","Thu","Fri","Fri","Fri","Fri","Fri","Fri","Sat","Sat","Sat","Sat","Sat","Sat"],["Apr","May","Jun","Jul","Aug","Sep","Apr","May","Jun","Jul","Aug","Sep","Apr","May","Jun","Jul","Aug","Sep","Apr","May","Jun","Jul","Aug","Sep","Apr","May","Jun","Jul","Aug","Sep","Apr","May","Jun","Jul","Aug","Sep","Apr","May","Jun","Jul","Aug","Sep"],[51251,56168,79656,76327,110246,116532,60861,63846,94655,93189,91633,137288,91185,76662,88134,137454,107124,163230,108631,89857,99654,147717,115256,135373,85067,128921,115325,148439,124117,153276,90303,133991,105056,102735,148674,160380,77218,102990,81364,90260,132225,162057]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>dayofweek<\/th>\n      <th>month<\/th>\n      <th>Trips<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```


```r
ggplot(dow_monthly_data, aes(dayofweek, Trips, fill = month))+
    geom_bar(stat = "identity", aes(fill = month), position = "dodge" )+
    ggtitle("Trips by Day and Month") + 
    scale_y_continuous(labels = comma) + 
    scale_fill_manual(values = colors)
```

![](Uber_Data_analysis2_files/figure-html/unnamed-chunk-16-1.png)<!-- -->

## **Number of Trips place during months in a year**


```r
month_data <- uber_data %>% group_by(month) %>% dplyr::summarize(Total = n())
```

```
## `summarise()` ungrouping output (override with `.groups` argument)
```

```r
datatable(month_data)
```

```{=html}
<div id="htmlwidget-7966e0ef2dda7c763ddc" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-7966e0ef2dda7c763ddc">{"x":{"filter":"none","data":[["1","2","3","4","5","6"],["Apr","May","Jun","Jul","Aug","Sep"],[564516,652435,663844,796121,829275,1028136]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>month<\/th>\n      <th>Total<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```

### Visualization


```r
ggplot(month_data,aes(month,Total))+
    geom_bar(stat = "Identity") + 
    ggtitle("Trips in a month") + 
    theme(legend.position = "none") + 
    scale_y_continuous(labels = comma) + 
    scale_fill_manual(values = colors)
```

![](Uber_Data_analysis2_files/figure-html/unnamed-chunk-18-1.png)<!-- -->

# **Heat-map visualization of day, hour and month**

#### **Heat-map by Hour and Day**


```r
ggplot(uber_data |> group_by(hour,day) |> dplyr::summarize(Trips = n()),aes(day,hour,Fill = Trips))+
    geom_tile(color = "white")+
    ggtitle("HeatMap for Trips")
```

```
## `summarise()` regrouping output by 'hour' (override with `.groups` argument)
```

![](Uber_Data_analysis2_files/figure-html/unnamed-chunk-19-1.png)<!-- -->


```r
day_hour_data <- uber_data %>% group_by(day, hour) %>% dplyr::summarize(Trips = n())
```

```
## `summarise()` regrouping output by 'day' (override with `.groups` argument)
```

```r
datatable(day_hour_data)
```

```{=html}
<div id="htmlwidget-2346d420e27b694a42e1" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2346d420e27b694a42e1">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744"],["1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","3","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","7","7","7","7","7","7","7","7","7","7","7","7","7","7","7","7","7","7","7","7","7","7","7","7","8","8","8","8","8","8","8","8","8","8","8","8","8","8","8","8","8","8","8","8","8","8","8","8","9","9","9","9","9","9","9","9","9","9","9","9","9","9","9","9","9","9","9","9","9","9","9","9","10","10","10","10","10","10","10","10","10","10","10","10","10","10","10","10","10","10","10","10","10","10","10","10","11","11","11","11","11","11","11","11","11","11","11","11","11","11","11","11","11","11","11","11","11","11","11","11","12","12","12","12","12","12","12","12","12","12","12","12","12","12","12","12","12","12","12","12","12","12","12","12","13","13","13","13","13","13","13","13","13","13","13","13","13","13","13","13","13","13","13","13","13","13","13","13","14","14","14","14","14","14","14","14","14","14","14","14","14","14","14","14","14","14","14","14","14","14","14","14","15","15","15","15","15","15","15","15","15","15","15","15","15","15","15","15","15","15","15","15","15","15","15","15","16","16","16","16","16","16","16","16","16","16","16","16","16","16","16","16","16","16","16","16","16","16","16","16","17","17","17","17","17","17","17","17","17","17","17","17","17","17","17","17","17","17","17","17","17","17","17","17","18","18","18","18","18","18","18","18","18","18","18","18","18","18","18","18","18","18","18","18","18","18","18","18","19","19","19","19","19","19","19","19","19","19","19","19","19","19","19","19","19","19","19","19","19","19","19","19","20","20","20","20","20","20","20","20","20","20","20","20","20","20","20","20","20","20","20","20","20","20","20","20","21","21","21","21","21","21","21","21","21","21","21","21","21","21","21","21","21","21","21","21","21","21","21","21","22","22","22","22","22","22","22","22","22","22","22","22","22","22","22","22","22","22","22","22","22","22","22","22","23","23","23","23","23","23","23","23","23","23","23","23","23","23","23","23","23","23","23","23","23","23","23","23","24","24","24","24","24","24","24","24","24","24","24","24","24","24","24","24","24","24","24","24","24","24","24","24","25","25","25","25","25","25","25","25","25","25","25","25","25","25","25","25","25","25","25","25","25","25","25","25","26","26","26","26","26","26","26","26","26","26","26","26","26","26","26","26","26","26","26","26","26","26","26","26","27","27","27","27","27","27","27","27","27","27","27","27","27","27","27","27","27","27","27","27","27","27","27","27","28","28","28","28","28","28","28","28","28","28","28","28","28","28","28","28","28","28","28","28","28","28","28","28","29","29","29","29","29","29","29","29","29","29","29","29","29","29","29","29","29","29","29","29","29","29","29","29","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","30","31","31","31","31","31","31","31","31","31","31","31","31","31","31","31","31","31","31","31","31","31","31","31","31"],["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],[3247,1982,1284,1331,1458,2171,3717,5470,5376,4688,4680,4811,5018,5887,7050,8033,8760,9661,8727,8146,7448,7960,6397,4128,2480,1600,1109,1442,1897,2861,5002,6646,6420,4795,4886,5067,5278,5801,7021,8581,10267,11301,11326,9654,8903,8506,7111,5247,3415,2176,1434,1489,1578,2437,4318,5775,5482,4732,4864,5162,5462,6189,7327,8991,10472,10665,11433,9765,9158,8646,7246,4767,2944,1718,1217,1449,1737,2623,4687,6146,5799,4814,4822,5067,5289,6273,7307,8678,9661,10550,10458,9296,8508,8804,7852,5224,2786,1567,1047,1278,1648,2958,4919,6379,6580,5616,5225,5097,5129,5780,7072,8453,9770,10887,10324,9582,9512,9785,9020,6640,4623,2932,1902,1599,1584,2201,3705,4846,5009,4482,4891,5264,5528,6378,7353,8751,9615,10130,9437,8575,8286,8734,8000,6061,3715,2326,1533,1622,1793,2464,4172,5649,5459,4706,4982,5266,5455,6315,7418,8624,10585,11185,10767,9674,8862,8692,7337,4902,2882,1672,1147,1509,1921,3282,5528,7474,7472,5770,5368,5433,5576,6424,7356,8910,10007,10871,9874,8964,8768,8528,6917,4331,2708,1757,1246,1501,1911,3227,5910,7720,7641,5983,5500,5542,5607,6540,7997,9360,10419,12116,11677,9979,9061,8806,7637,5290,3351,2167,1495,1466,1614,2652,4757,6168,6271,5165,5070,5513,5617,6631,7739,9772,11256,12112,11121,9800,9876,9403,7886,5598,3093,1699,1126,1450,1870,2569,5046,7001,6990,5489,5313,5515,5611,6619,7642,9097,10327,11098,10558,9524,8982,8885,7907,5449,3276,2187,1419,1386,1787,2773,4679,6370,6360,5277,5248,5417,5674,6535,7868,9537,10912,11919,12450,10589,10154,10496,10189,8104,5517,3594,2312,1865,1730,2380,4269,5768,6180,5734,5535,5844,6015,6798,8354,9437,10736,12059,11672,10134,8855,8573,7497,6034,3810,2399,1637,1689,1784,2678,4325,5879,5618,4909,4998,5206,5251,5855,7083,8340,9698,10296,9726,9310,9350,8759,7007,4541,2543,1557,1115,1416,1909,3047,5142,6957,6847,5286,5434,5622,5614,7127,7784,8647,10469,12188,11941,11231,10715,9278,7286,4571,2595,1622,1142,1429,1851,3024,5653,7658,7627,6063,5720,5564,5621,6298,7731,9450,11002,11998,11071,11147,10335,10585,8251,5484,3208,2084,1532,1517,1924,2778,4637,6432,5993,5015,5089,5407,5739,6613,7610,9149,10505,11445,11314,10113,10122,9993,8509,5796,3447,2178,1364,1657,1928,3027,4785,6738,6565,5463,5237,5580,5586,6496,7673,9199,10485,10879,10557,9757,9512,9457,8167,5582,3277,2235,1637,1710,1837,2688,4826,6265,6138,5088,5173,5335,5685,6487,7515,9076,10086,10966,10639,9885,10242,10241,9271,6786,4567,3263,2134,1889,1647,2181,3632,4975,5173,4837,5228,5776,5871,6799,7636,8809,9637,10254,9467,8779,8792,8875,7943,6015,4381,3265,2013,1761,1960,2665,4260,5823,5610,4771,4992,5308,5569,6192,7199,8266,9630,9990,9487,8482,8254,8413,7499,5322,2852,1662,1207,1503,1984,3222,5315,6981,6995,5305,5362,5452,5614,6458,7470,9323,10776,11175,10077,9164,8920,8599,6911,4625,2605,1608,1163,1465,1994,3182,5315,7027,6564,5271,5159,5424,5612,6362,7733,9498,10162,10536,11044,11578,11678,10544,8821,5687,3277,2090,1480,1520,1825,2802,4565,6111,6024,5242,5027,5408,5318,6078,7207,8857,10567,10982,9954,9251,9379,9022,7636,4547,2442,1525,1098,1472,1972,3029,5465,7775,7214,6097,5533,5604,5805,6327,7437,8885,10114,10699,10889,9212,8945,9702,8687,6739,3887,3123,2087,1840,1770,2389,3838,5282,5169,4913,5169,5293,5494,6288,7419,8972,10057,10895,11087,10314,10009,10666,9688,7756,5304,3712,2407,2098,1759,2380,3609,5023,5142,4855,5299,5829,5943,6957,7654,8969,9980,10032,9425,8447,8077,8707,7868,6176,4224,2711,1894,1846,1916,2846,4368,5828,5759,5283,5332,5616,5600,6241,7480,8753,9877,10175,9322,8435,8479,8097,6519,4556,2732,1862,1442,1717,1990,3127,5329,6992,6825,5586,5321,5256,5331,6419,7760,9416,10316,11333,10598,9476,9439,9287,7122,4410,2439,1547,1135,1436,1864,3264,5850,7735,7760,6168,6084,6202,6543,7385,8554,10456,11769,12378,12807,11249,11060,10246,8433,4796,2209,1407,1107,935,788,1012,1590,2201,2442,2564,2607,2823,2997,3325,4176,5177,5483,5415,5450,5001,4923,5171,5244,4026]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>day<\/th>\n      <th>hour<\/th>\n      <th>Trips<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```


```r
ggplot(day_hour_data, aes(day, hour, fill = Trips)) + 
geom_tile(color = "white") + 
ggtitle("Heat Map by Hour and Day")
```

![](Uber_Data_analysis2_files/figure-html/unnamed-chunk-21-1.png)<!-- -->


```r
day_month <- uber_data |> group_by(day,month) |> dplyr::summarize(Trips = n())
```

```
## `summarise()` regrouping output by 'day' (override with `.groups` argument)
```

```r
ggplot(day_month, aes(day, month, fill = Trips)) + 
geom_tile(color = "white") + 
ggtitle("Heat Map by Month and Day")
```

![](Uber_Data_analysis2_files/figure-html/unnamed-chunk-22-1.png)<!-- -->


```r
month_base <-  uber_data %>%
                    group_by(Base, month) %>%
                        dplyr::summarize(Total = n()) 
```

```
## `summarise()` regrouping output by 'Base' (override with `.groups` argument)
```

```r
day0fweek_bases <-  uber_data %>%
                    group_by(Base, dayofweek) %>%
                        dplyr::summarize(Total = n()) 
```

```
## `summarise()` regrouping output by 'Base' (override with `.groups` argument)
```

```r
ggplot(month_base, aes(Base, month, fill = Total)) +
            geom_tile(color = "white") +
            ggtitle("Heat Map by Month and Bases")
```

![](Uber_Data_analysis2_files/figure-html/unnamed-chunk-23-1.png)<!-- -->


```r
ggplot(day0fweek_bases, aes(Base, dayofweek, fill = Total)) +
            geom_tile(color = "white") +
              ggtitle("Heat Map by Bases and Day of Week")
```

![](Uber_Data_analysis2_files/figure-html/unnamed-chunk-24-1.png)<!-- -->

## Creating a map visualization of rides in New York

In the final section, we will visualize the rides in New York city by creating a geo-plot that will help us to visualize the rides during 2014 (Apr -- Sep) and by the bases in the same period.


```r
min_lat <- 40.5774
max_lat <- 40.9176
min_long <- -74.15
max_long <- -73.7004

ggplot(uber_data, aes(x=Lon, y=Lat)) +
  geom_point(size=1, color = "blue") +
     scale_x_continuous(limits=c(min_long, max_long)) +
      scale_y_continuous(limits=c(min_lat, max_lat)) +
        theme_map() +
           ggtitle("NYC MAP BASED ON UBER RIDES DURING 2014 (APR-SEP)")
```

```
## Warning: Removed 71701 rows containing missing values (geom_point).
```

![](Uber_Data_analysis2_files/figure-html/unnamed-chunk-25-1.png)<!-- -->


```r
ggplot(uber_data, aes(x=Lon, y=Lat, color = Base)) +
  geom_point(size=1) +
     scale_x_continuous(limits=c(min_long, max_long)) +
      scale_y_continuous(limits=c(min_lat, max_lat)) +
       theme_map() +
          ggtitle("NYC MAP BASED ON UBER RIDES DURING 2014 (APR-SEP) by BASE")
```

```
## Warning: Removed 71701 rows containing missing values (geom_point).
```

![](Uber_Data_analysis2_files/figure-html/unnamed-chunk-26-1.png)<!-- -->
